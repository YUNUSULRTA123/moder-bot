# ü§ñ –ë–æ—Ç-–º–æ–¥–µ—Ä–∞—Ç–æ—Ä –¥–ª—è —á–∞—Ç–∞ (—Ä–æ–ª–∏ + –∞–Ω—Ç–∏-—Ä–µ–∫–ª–∞–º–∞)

## üß© –û–±—â–∏–π –ø–æ—Ä—è–¥–æ–∫ —Ä–∞–±–æ—Ç (–≤—Å–µ–º –ø–æ–Ω–∏–º–∞—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤–æ)

1. –û–ø—Ä–µ–¥–µ–ª—è–µ–º **–µ–¥–∏–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏**
   - `user_id`
   - `chat_id`
   - `role`
   - `violations_count`
   - `messages_count`
   - `join_date`

2. –î–æ–≥–æ–≤–∞—Ä–∏–≤–∞–µ–º—Å—è –æ **–µ–¥–∏–Ω–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ**
   - –¢–∞–±–ª–∏—Ü–∞ `users`
   - –¢–∞–±–ª–∏—Ü–∞ `violations`
   - –¢–∞–±–ª–∏—Ü–∞ `roles_config` (–ø–æ—Ä–æ–≥–∏)

3. Core Logic:
   - Listener ‚Üí –ø–µ—Ä–µ–¥–∞—ë—Ç —Å–æ–±—ã—Ç–∏—è –≤ –Ω—É–∂–Ω—ã–π –º–æ–¥—É–ª—å
   - –ö–∞–∂–¥—ã–π –º–æ–¥—É–ª—å **–Ω–∏—á–µ–≥–æ –Ω–µ –∑–Ω–∞–µ—Ç –æ UI**, —Ç–æ–ª—å–∫–æ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ—à–µ–Ω–∏–µ

---

# üë®‚Äçüíª –ó–∞–¥–∞—á–∏ –ø–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º

## üî• –î–∏–º–∞ ‚Äî **–°–∏—Å—Ç–µ–º–∞ –Ω–∞–∫–∞–∑–∞–Ω–∏–π (Punishment System)**

### –¶–µ–ª—å
–ï–¥–∏–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º, –∫–æ—Ç–æ—Ä—ã–π —Ä–µ—à–∞–µ—Ç:
> *—á—Ç–æ –¥–µ–ª–∞—Ç—å —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –ø–æ—Å–ª–µ –Ω–∞—Ä—É—à–µ–Ω–∏—è*

### –ê–ª–≥–æ—Ä–∏—Ç–º –î–∏–º—ã

#### 1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
```text
user_id
chat_id
count
last_violation_at
```

#### 2. API –º–æ–¥—É–ª—è (—Ñ—É–Ω–∫—Ü–∏–∏)
```python
add_violation(user_id, chat_id, reason) -> action
reset_violations(user_id)
get_violation_level(user_id) -> int
```

#### 3. –õ–æ–≥–∏–∫–∞ –Ω–∞–∫–∞–∑–∞–Ω–∏–π
```text
1 ‚Üí warning
2 ‚Üí mute 10 min
3 ‚Üí mute 24h
4 ‚Üí ban
```

–ü—Å–µ–≤–¥–æ–∫–æ–¥:
```python
count += 1

if count == 1:
    action = "warn"
elif count == 2:
    action = "mute_10m"
elif count == 3:
    action = "mute_24h"
else:
    action = "ban"
```

#### 4. –ß—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–æ–¥—É–ª—å
```json
{
  "action": "mute_10m",
  "duration": 600,
  "reason": "–†–µ–∫–ª–∞–º–∞"
}
```

#### 5. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ
- –∞–≤—Ç–æ-—Å–±—Ä–æ—Å –Ω–∞—Ä—É—à–µ–Ω–∏–π —á–µ—Ä–µ–∑ N –¥–Ω–µ–π
- –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ª–∏–º–∏—Ç—ã –¥–ª—è —Ä–æ–ª–µ–π

---

## üé≠ –ê—Ä—Ç—ë–º ‚Äî **–ü–æ–≤—ã—à–µ–Ω–∏–µ —Ä–æ–ª–µ–π –≤ Telegram**

### –¶–µ–ª—å
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∞–ø–∞—Ç—å —Ä–æ–ª–∏ –ø–æ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

### –ê–ª–≥–æ—Ä–∏—Ç–º –ê—Ä—Ç—ë–º–∞

#### 1. –†–æ–ª–∏ –∏ —É—Å–ª–æ–≤–∏—è
```text
–ù–æ–≤–∏—á–æ–∫ ‚Üí —Å—Ä–∞–∑—É
–£—á–∞—Å—Ç–Ω–∏–∫ ‚Üí 50 —Å–æ–æ–±—â–µ–Ω–∏–π
–ê–∫—Ç–∏–≤–Ω—ã–π ‚Üí 7 –¥–Ω–µ–π + 200 —Å–æ–æ–±—â–µ–Ω–∏–π
```

#### 2. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
```text
user_id
chat_id
role
messages_count
join_date
```

#### 3. –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π
```python
messages_count += 1
check_role_upgrade(user)
```

#### 4. –õ–æ–≥–∏–∫–∞ –ø–æ–≤—ã—à–µ–Ω–∏—è
```python
if role == "–ù–æ–≤–∏—á–æ–∫" and messages >= 50:
    set_role("–£—á–∞—Å—Ç–Ω–∏–∫")

if role == "–£—á–∞—Å—Ç–Ω–∏–∫" and days >= 7 and messages >= 200:
    set_role("–ê–∫—Ç–∏–≤–Ω—ã–π")
```

#### 5. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram
- `restrict_chat_member` (–¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤)
- `promote_chat_member` (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
- –∫–∞—Å—Ç–æ–º–Ω—ã–µ —Ä–æ–ª–∏ –º–æ–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å **–ª–æ–≥–∏—á–µ—Å–∫–∏**, –∞ –Ω–µ —Å–∏—Å—Ç–µ–º–Ω–æ

---

## üö´üì¢ –Æ–Ω—É—Å ‚Äî **–ê–Ω—Ç–∏-—Ä–µ–∫–ª–∞–º–Ω—ã–π –º–æ–¥—É–ª—å (Anti-Ad Filter)**

### –¢–í–û–Ø –ó–û–ù–ê üí•
–¢—ã —Ä–µ—à–∞–µ—à—å: **—ç—Ç–æ —Ä–µ–∫–ª–∞–º–∞ –∏–ª–∏ –Ω–µ—Ç**

### 1. –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
```python
message_text
user_id
user_role
join_date
```

### 2. –£—Ä–æ–≤–Ω–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ (–ø–æ –ø–æ—Ä—è–¥–∫—É)

#### üîπ –£—Ä–æ–≤–µ–Ω—å 1 ‚Äî –†–µ–≥—É–ª—è—Ä–∫–∏ (–±—ã—Å—Ç—Ä–æ)
```regex
http(s)?://
t\.me/
bit\.ly
@
```
–ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–æ ‚Üí `suspicious = True`

#### üîπ –£—Ä–æ–≤–µ–Ω—å 2 ‚Äî –°—Ç–æ–ø-—Å–ª–æ–≤–∞
```python
STOP_WORDS = [
  "–∑–∞—Ä–∞–±–æ—Ç–æ–∫",
  "–∫—Ä–∏–ø—Ç–∞",
  "–∫–∞–∑–∏–Ω–æ",
  "–ø–æ–¥–ø–∏—à–∏—Å—å",
  "–∏–Ω–≤–µ—Å—Ç"
]
```
–ï—Å–ª–∏ ‚â•1 —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è ‚Üí `suspicious = True`

#### üîπ –£—Ä–æ–≤–µ–Ω—å 3 ‚Äî –ö–æ–Ω—Ç–µ–∫—Å—Ç
```python
if user_role == "–ù–æ–≤–∏—á–æ–∫":
    multiplier = 2
else:
    multiplier = 1
```

### 3. –ò—Ç–æ–≥–æ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ
```python
score = regex_hits*2 + stop_words_hits*1
score *= multiplier

if score >= 3:
    return "violation"
else:
    return "ok"
```

### 4. –ß—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–æ–¥—É–ª—å
```json
{
  "is_ad": true,
  "confidence": 0.85,
  "reason": "link + stopword"
}
```

### 5. –°–≤—è–∑—å —Å —Å–∏—Å—Ç–µ–º–æ–π –Ω–∞–∫–∞–∑–∞–Ω–∏–π
```python
if is_ad:
    punishment.add_violation(user_id, reason="–†–µ–∫–ª–∞–º–∞")
```

### 6. MVP –≤–µ—Ä—Å–∏—è
- ‚ùå —Å—Å—ã–ª–∫–∏ –æ—Ç –Ω–æ–≤–∏—á–∫–æ–≤ ‚Üí —Å—Ä–∞–∑—É –Ω–∞—Ä—É—à–µ–Ω–∏–µ
- ‚ùå 2 —Å—Ç–æ–ø-—Å–ª–æ–≤–∞ ‚Üí –Ω–∞—Ä—É—à–µ–Ω–∏–µ
- –±–µ–∑ ML, —Ç–æ–ª—å–∫–æ –ª–æ–≥–∏–∫–∞

---

## üß† –ö–∞–∫ –≤—Å—ë —Å–æ–µ–¥–∏–Ω—è–µ—Ç—Å—è
```
Message ‚Üí
  AntiAdFilter ‚Üí
    if violation ‚Üí
      PunishmentSystem ‚Üí
        Action ‚Üí
          Telegram API
```

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥
- –Ω–∞–ø–∏—Å–∞—Ç—å **—Å–∫–µ–ª–µ—Ç –ø—Ä–æ–µ–∫—Ç–∞ (–ø–∞–ø–∫–∏ + —Ñ–∞–π–ª—ã)**
- –∏–ª–∏ **–∫–æ–¥ Anti-Ad –º–æ–¥—É–ª—è –Ω–∞ Python**
- –∏–ª–∏ **—Å—Ö–µ–º—É –ë–î –ø–æ–¥ –≤–∞—à MVP**

